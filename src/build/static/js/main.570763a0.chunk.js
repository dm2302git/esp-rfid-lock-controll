(this["webpackJsonplock-admin"]=this["webpackJsonplock-admin"]||[]).push([[0],{366:function(e,t,c){},482:function(e,t,c){},506:function(e,t,c){"use strict";c.r(t);var a=c(5),r=c(0),n=c(14),s=c.n(n),o=(c(366),c(597)),i=c(596),j=c(327),l=c(17),u=c(599),b=c(598),d=c(581),O=c(582),x=c(583),h=c(584),m=c(180),p=c(567),f=c(90),y=c(607),v=c(608),g=c(609),w=function(e){var t=e.className,c=(e.exporter,e.filters),n=e.maxResults,s=Object(m.a)(e,["className","exporter","filters","maxResults"]),o=Object(p.a)(),i=o.currentSort,j=o.resource,u=o.displayedFilters,b=o.filterValues,d=o.basePath,O=o.showFilter,x=o.total;return Object(a.jsxs)(f.a,Object(l.a)(Object(l.a)({className:t},Object(y.c)(s)),{},{children:[c&&Object(r.cloneElement)(c,{resource:j,showFilter:O,displayedFilters:u,filterValues:b,context:"button"}),Object(a.jsx)(v.a,{basePath:d}),Object(a.jsx)(g.a,{disabled:0===x,resource:j,sort:i,filterValues:b,maxResults:n})]}))},k=function(e){return Object(a.jsx)(u.a,Object(l.a)(Object(l.a)({actions:Object(a.jsx)(w,{})},e),{},{children:Object(a.jsxs)(b.a,{children:[Object(a.jsx)(d.a,{source:"name"}),Object(a.jsx)(d.a,{source:"uid"}),Object(a.jsx)(O.a,{source:"validUntil",showTime:!0,locales:"de"}),Object(a.jsx)(x.a,{source:"isOneTimeCode"}),Object(a.jsx)(h.a,{})]})}))},P=c(604),T=c(600),E=c(586),C=c(587),N=c(606),S=c(601),I=c(611),D=function(e){return Object(a.jsx)(P.a,Object(l.a)(Object(l.a)({title:"Create a Post"},e),{},{children:Object(a.jsxs)(T.a,{children:[Object(a.jsx)(E.a,{source:"name"}),Object(a.jsx)(E.a,{source:"uid"}),Object(a.jsx)(C.a,{source:"validUntil",showTime:!0,locales:"de"}),Object(a.jsx)(N.a,{source:"isOneTimeCode"}),Object(a.jsx)(S.a,Object(l.a)(Object(l.a)({reference:"newkey",source:"newkey_id",allowEmpty:!0},e),{},{children:Object(a.jsx)(I.a,{optionText:"uid"})}))]})}))},F=c(602),L=c(590),R=function(e){return Object(a.jsx)(F.a,Object(l.a)(Object(l.a)({},e),{},{children:Object(a.jsxs)(T.a,{children:[Object(a.jsx)(E.a,{disabled:!0,source:"id"}),Object(a.jsx)(E.a,{source:"uid",disabled:!0}),Object(a.jsx)(E.a,{source:"name"}),Object(a.jsx)(L.a,{label:"valid until",source:"validUntil",showTime:!0,locales:"de"}),Object(a.jsx)(N.a,{source:"isOneTimeCode"})]})}))},A=c(78),J=c.n(A),U=c(119),H=c(131),B=c(31),K=c(589),V=c(579),Y=c(591),M=c(516),_=c(592),q=c(314),W=c.n(q),z={width:300,minHeight:250,margin:"0.5em",display:"inline-block",verticalAlign:"top"};function G(e){var t=e.date,c=new Date(t),r=c instanceof Date?c:new Date,n=new Date,s=new Date(Math.abs(n-r)).getTime()/1e3;return Object(a.jsxs)("div",{children:[Math.round(s)," seconds ago"]})}var Q=function(){var e=Object(p.a)(),t=e.ids,c=e.data,r=Object(H.a)(),n=function(){var e=Object(U.a)(J.a.mark((function e(t){var c,a;return J.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,fetch("/".concat(t));case 3:return c=e.sent,e.next=6,c.json();case 6:a=e.sent,r("door opened","info"),console.log(a),e.next=15;break;case 11:e.prev=11,e.t0=e.catch(0),console.log(e.t0),r("could not open door","error");case 15:case"end":return e.stop()}}),e,null,[[0,11]])})));return function(t){return e.apply(this,arguments)}}();return Object(a.jsx)("div",{style:{margin:"1em"},children:t.map((function(e){return Object(a.jsxs)(V.a,{style:z,children:[Object(a.jsx)(Y.a,{title:Object(a.jsx)(d.a,{record:c[e],source:"readerName"}),subheader:Object(a.jsx)(d.a,{record:c[e],source:"ip"})}),Object(a.jsxs)(M.a,{children:[Object(a.jsx)(O.a,{record:c[e],source:"lastPing",showTime:!0,locales:"de"}),Object(a.jsx)(G,{date:c[e].lastPing})]}),Object(a.jsxs)(_.a,{style:{textAlign:"right"},children:[Object(a.jsx)(B.a,{onClick:function(){return n(e)},label:"open",variant:"contained",children:Object(a.jsx)(W.a,{})}),Object(a.jsx)(K.a,{label:"SHOW",record:c[e],variant:"contained",basePath:"reader"})]})]},e)}))})},X=function(e){return Object(a.jsx)(u.a,Object(l.a)(Object(l.a)({title:"All Readers"},e),{},{children:Object(a.jsx)(Q,{})}))},Z=c(329),$=c(585),ee=c(593),te=c(594),ce=c(595),ae=c(612),re=c(603),ne=c(511),se="/api",oe=function(e){e.basePath;var t=e.data,c=(e.resource,Object(H.a)()),r=Object(ne.a)(),n=function(){var e=Object(U.a)(J.a.mark((function e(a){var r,n;return J.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,fetch("".concat(se,"/opendoor/").concat(t.id,"?port=").concat(a));case 3:return r=e.sent,e.next=6,r.json();case 6:n=e.sent,c("door ".concat(t.id," opened port ").concat(a),"info"),console.log(n),e.next=15;break;case 11:e.prev=11,e.t0=e.catch(0),console.log(e.t0),c("could not open door","error");case 15:case"end":return e.stop()}}),e,null,[[0,11]])})));return function(t){return e.apply(this,arguments)}}(),s=function(){var e=Object(U.a)(J.a.mark((function e(){var a,n;return J.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,fetch("".concat(se,"/deleteall/").concat(t.id));case 3:return a=e.sent,e.next=6,a.json();case 6:n=e.sent,c(n.message?n.message:"reader ".concat(t.id," deleted all keys. Reader keys will be refreshed shortly"),"info"),setTimeout(r,1e3),e.next=15;break;case 11:e.prev=11,e.t0=e.catch(0),console.log(e.t0),c("could not delete keys on reader ".concat(t.id),"error");case 15:case"end":return e.stop()}}),e,null,[[0,11]])})));return function(){return e.apply(this,arguments)}}(),o=function(){var e=Object(U.a)(J.a.mark((function e(){var a,r;return J.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,fetch("".concat(se,"/syncall/").concat(t.id));case 3:return a=e.sent,e.next=6,a.json();case 6:r=e.sent,c(r.message?r.message:"reader ".concat(t.id," synced all keys"),"info"),console.log(r),e.next=15;break;case 11:e.prev=11,e.t0=e.catch(0),console.log(e.t0),c("failed to sync to reader ".concat(t.id),"error");case 15:case"end":return e.stop()}}),e,null,[[0,11]])})));return function(){return e.apply(this,arguments)}}(),i={marginLeft:"8px"};return Object(a.jsxs)(f.a,{children:[Object(a.jsx)(B.a,{label:"OPEN 1",color:"primary",variant:"contained",onClick:function(){return n(1)}}),Object(a.jsx)(B.a,{style:i,label:"OPEN 2",color:"primary",variant:"contained",onClick:function(){return n(2)}}),Object(a.jsx)(B.a,{style:i,label:"OPEN 3",color:"primary",variant:"contained",onClick:function(){return n(3)}}),Object(a.jsx)(B.a,{style:i,label:"OPEN 4",color:"primary",variant:"contained",onClick:function(){return n(4)}}),Object(a.jsx)(B.a,{style:i,label:"SYNC ALL!",color:"secondary",variant:"contained",onClick:o}),Object(a.jsx)(B.a,{style:i,label:"DELETE ALL!",color:"secondary",variant:"contained",onClick:s})]})},ie=function(e){return Object(a.jsx)(Z.a,Object(l.a)(Object(l.a)({},e),{},{children:Object(a.jsx)($.a,{})}))},je=function(e){e.children;var t=Object(m.a)(e,["children"]),c=t.record.keys,r=void 0===c?[]:c;return Object(a.jsxs)(ee.a,Object(l.a)(Object(l.a)({},t),{},{children:[Object(a.jsx)(d.a,{source:"readerName"}),Object(a.jsx)(d.a,{source:"ip"}),Object(a.jsx)(O.a,{source:"lastPing",showTime:!0,locales:"de"}),Object(a.jsx)(P.a,{resource:t.resource,children:Object(a.jsx)(T.a,{toolbar:Object(a.jsx)(ie,{}),margin:"none",children:Object(a.jsx)(S.a,{reference:"key",source:"key_id",allowEmpty:!0,children:Object(a.jsx)(I.a,{optionText:"name"})})})}),Object(a.jsx)(te.a,{label:"KEYS IN THE DB",source:"keys",children:Object(a.jsxs)(b.a,{children:[Object(a.jsx)(d.a,{source:"name"}),Object(a.jsx)(d.a,{source:"uid"}),Object(a.jsx)(O.a,{source:"validUntil",showTime:!0,locales:"de"}),Object(a.jsx)(x.a,{source:"isOneTimeCode"}),Object(a.jsx)(ce.a,{source:"acctype"}),Object(a.jsx)(ce.a,{source:"acctype2"}),Object(a.jsx)(ce.a,{source:"acctype3"}),Object(a.jsx)(ce.a,{source:"acctype4"})]})}),Object(a.jsx)(ae.a,Object(l.a)(Object(l.a)({reference:"readerkey",target:"readerId",label:"KEYS ON READER",allowEmpty:!0},t),{},{children:Object(a.jsxs)(b.a,Object(l.a)(Object(l.a)({rowStyle:function(e,c){return console.log(e,c,t),{backgroundColor:r.find((function(t){return t.uid===e.uid&&t.name===e.name&&t.acctype===e.acctype&&t.acctype2===e.acctype2&&t.acctype3===e.acctype3&&t.acctype4===e.acctype4}))?"#efe":"white"}}},t),{},{children:[console.log(t),Object(a.jsx)(d.a,{source:"name"}),Object(a.jsx)(d.a,{source:"uid"}),Object(a.jsx)(O.a,{source:"validUntil",showTime:!0,locales:"de"}),Object(a.jsx)(ce.a,{source:"acctype"}),Object(a.jsx)(ce.a,{source:"acctype2"}),Object(a.jsx)(ce.a,{source:"acctype3"}),Object(a.jsx)(ce.a,{source:"acctype4"})]}))}))]}))},le=function(e){return Object(a.jsx)(re.a,Object(l.a)(Object(l.a)({title:" ",actions:Object(a.jsx)(oe,{})},e),{},{children:Object(a.jsx)(je,{})}))},ue=(c(482),function(e){return Object(a.jsx)(u.a,Object(l.a)(Object(l.a)({},e),{},{children:Object(a.jsxs)(b.a,{children:[Object(a.jsx)(d.a,{source:"door"}),Object(a.jsx)(d.a,{source:"type"}),Object(a.jsx)(d.a,{source:"src"}),Object(a.jsx)(d.a,{source:"description"}),Object(a.jsx)(d.a,{source:"data"}),Object(a.jsx)(O.a,{source:"time",showTime:!0,locales:"de"})]})}))}),be=function(e){return Object(a.jsx)(u.a,Object(l.a)(Object(l.a)({},e),{},{children:Object(a.jsxs)(b.a,{children:[Object(a.jsx)(d.a,{source:"uid"}),Object(a.jsx)(d.a,{source:"name"}),Object(a.jsx)(d.a,{source:"door"}),Object(a.jsx)(d.a,{source:"type"}),Object(a.jsx)(d.a,{source:"access"}),Object(a.jsx)(O.a,{source:"time",showTime:!0,locales:"de"}),Object(a.jsx)(x.a,{source:"isKnown"})]})}))},de=function(e){return Object(a.jsx)(u.a,Object(l.a)(Object(l.a)({},e),{},{children:Object(a.jsxs)(b.a,{children:[Object(a.jsx)(d.a,{source:"uid"}),Object(a.jsx)(d.a,{source:"door"}),Object(a.jsx)(d.a,{source:"name"}),Object(a.jsx)(O.a,{source:"time",showTime:!0,locales:"de"})]})}))},Oe={login:function(e){var t=e.username,c=e.password,a=new Request("".concat("/api","/login"),{method:"POST",body:JSON.stringify({username:t,password:c}),headers:new Headers({"Content-Type":"application/json"})});return fetch(a).then((function(e){if(e.status<200||e.status>=300)throw new Error(e.statusText);return e.json()})).then((function(e){var t=e.user;if(!t)throw Error("no user data found in response");localStorage.setItem("auth",JSON.stringify({id:t.id,avatar:null,fullName:t.username}))})).catch((function(e){throw new Error(e)}))},checkError:function(e){var t=e.status;return 401===t||403===t?(localStorage.removeItem("auth"),Promise.reject({message:!1})):Promise.resolve()},checkAuth:function(){return localStorage.getItem("auth")?Promise.resolve():Promise.reject()},logout:function(){return localStorage.removeItem("auth"),Promise.resolve()},getIdentity:function(){try{var e=JSON.parse(localStorage.getItem("auth")),t=e.id,c=e.fullName,a=e.avatar;return Promise.resolve({id:t,fullName:c,avatar:a})}catch(r){return Promise.reject(r)}},getPermissions:function(){var e=localStorage.getItem("permissions");return e?Promise.resolve(e):Promise.reject()}};var xe=function(){var e="/api";return Object(a.jsxs)(o.a,{dataProvider:Object(j.a)(e),locale:"en",authProvider:Oe,children:[Object(a.jsx)(i.a,{name:"reader",list:X,show:le}),Object(a.jsx)(i.a,{name:"key",list:k,create:D,edit:R}),Object(a.jsx)(i.a,{name:"newkey",list:de}),Object(a.jsx)(i.a,{name:"event",list:ue}),Object(a.jsx)(i.a,{name:"access",list:be}),Object(a.jsx)(i.a,{name:"readerkey"})]})},he=function(e){e&&e instanceof Function&&c.e(3).then(c.bind(null,613)).then((function(t){var c=t.getCLS,a=t.getFID,r=t.getFCP,n=t.getLCP,s=t.getTTFB;c(e),a(e),r(e),n(e),s(e)}))};s.a.render(Object(a.jsx)(xe,{}),document.getElementById("root")),he()}},[[506,1,2]]]);
//# sourceMappingURL=main.570763a0.chunk.js.map